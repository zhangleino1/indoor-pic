<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 800 650" xmlns="http://www.w3.org/2000/svg">
  <!-- Color definitions -->
  <defs>
    <linearGradient id="blueBackground" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f8f8f8;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="orangeGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ff9f50;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ff7f33;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="redGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ff5a4c;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e03c2b;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="yellowGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ffe40f;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffb912;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="purpleGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#b969f6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#9e44dd;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- Add Title -->
  <text x="400" y="35" font-family="Arial" font-size="22" font-weight="bold" text-anchor="middle" fill="#333">神经网络架构与Transformer层</text>

  <!-- Output Layer -->
  <rect x="200" y="80" width="400" height="40" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="2" />
  <text x="100" y="105" font-family="Arial" font-size="16" fill="#333" font-weight="bold">输出层</text>
  <text x="620" y="105" font-family="Arial" font-size="16" fill="#333">16个神经元</text>
  
  <!-- Output Neurons -->
  <circle cx="235" cy="100" r="12" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1.5" />
  <circle cx="275" cy="100" r="12" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1.5" />
  <circle cx="315" cy="100" r="12" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1.5" />
  <text x="355" y="105" font-family="Arial" font-size="16" fill="#333" font-weight="bold">. . .</text>
  <circle cx="565" cy="100" r="12" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1.5" />

  <!-- Transformer Layer (NEW) -->
  <rect x="200" y="150" width="400" height="40" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="2" />
  <text x="100" y="175" font-family="Arial" font-size="16" fill="#333" font-weight="bold">Transformer层</text>
  <text x="620" y="175" font-family="Arial" font-size="16" fill="#333">8个注意力头</text>
  
  <!-- Transformer Components -->
  <circle cx="235" cy="170" r="12" fill="url(#purpleGradient)" stroke="#2c3e50" stroke-width="1.5" />
  <circle cx="275" cy="170" r="12" fill="url(#purpleGradient)" stroke="#2c3e50" stroke-width="1.5" />
  <circle cx="315" cy="170" r="12" fill="url(#redGradient)" stroke="#2c3e50" stroke-width="1.5" />
  <text x="355" y="175" font-family="Arial" font-size="16" fill="#333" font-weight="bold">. . .</text>
  <circle cx="525" cy="170" r="12" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1.5" />
  <circle cx="565" cy="170" r="12" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1.5" />

  <!-- Fully connected Layer -->
  <rect x="200" y="220" width="400" height="40" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="2" />
  <text x="100" y="245" font-family="Arial" font-size="16" fill="#333" font-weight="bold">全连接层</text>
  
  <!-- FC Layer Neurons -->
  <circle cx="235" cy="240" r="12" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1.5" />
  <circle cx="275" cy="240" r="12" fill="url(#redGradient)" stroke="#2c3e50" stroke-width="1.5" />
  <text x="355" y="245" font-family="Arial" font-size="16" fill="#333" font-weight="bold">. . .</text>
  <circle cx="565" cy="240" r="12" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1.5" />

  <!-- Convolution Block 1 -->
  <rect x="200" y="290" width="400" height="40" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="2" />
  <text x="80" y="315" font-family="Arial" font-size="16" fill="#333" font-weight="bold">卷积块</text>
  <text x="620" y="315" font-family="Arial" font-size="16" fill="#333">32个滤波器</text>
  
  <!-- Conv Block 1 Filters -->
  <rect x="230" y="295" width="50" height="30" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="245" cy="310" r="10" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="265" cy="310" r="10" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1" />
  
  <rect x="320" y="295" width="50" height="30" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="335" cy="310" r="10" fill="url(#redGradient)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="355" cy="310" r="10" fill="url(#redGradient)" stroke="#2c3e50" stroke-width="1" />
  
  <text x="400" y="315" font-family="Arial" font-size="16" fill="#333" font-weight="bold">. . .</text>
  
  <rect x="520" y="295" width="50" height="30" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="535" cy="310" r="10" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="555" cy="310" r="10" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1" />

  <!-- Convolution Block 2 -->
  <rect x="200" y="360" width="400" height="40" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="2" />
  <text x="80" y="385" font-family="Arial" font-size="16" fill="#333" font-weight="bold">卷积块</text>
  <text x="620" y="385" font-family="Arial" font-size="16" fill="#333">32个滤波器</text>
  
  <!-- Conv Block 2 Filters -->
  <rect x="230" y="365" width="50" height="30" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="245" cy="380" r="10" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="265" cy="380" r="10" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1" />
  
  <rect x="320" y="365" width="50" height="30" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="335" cy="380" r="10" fill="url(#redGradient)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="355" cy="380" r="10" fill="url(#redGradient)" stroke="#2c3e50" stroke-width="1" />
  
  <text x="400" y="385" font-family="Arial" font-size="16" fill="#333" font-weight="bold">. . .</text>
  
  <rect x="520" y="365" width="50" height="30" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="535" cy="380" r="10" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="555" cy="380" r="10" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1" />

  <!-- Convolution Block 3 -->
  <rect x="200" y="430" width="400" height="40" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="2" />
  <text x="80" y="455" font-family="Arial" font-size="16" fill="#333" font-weight="bold">卷积块</text>
  <text x="620" y="455" font-family="Arial" font-size="16" fill="#333">16个滤波器</text>
  
  <!-- Conv Block 3 Filters -->
  <rect x="230" y="435" width="80" height="30" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="245" cy="450" r="10" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="270" cy="450" r="10" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="295" cy="450" r="10" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1" />
  
  <text x="350" y="455" font-family="Arial" font-size="16" fill="#333" font-weight="bold">. . .</text>
  
  <rect x="490" y="435" width="80" height="30" rx="3" ry="3" fill="url(#blueBackground)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="510" cy="450" r="10" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="535" cy="450" r="10" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1" />
  <circle cx="560" cy="450" r="10" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1" />

  <!-- Input Signal -->
  <text x="80" y="530" font-family="Arial" font-size="16" fill="#333" font-weight="bold">输入信号</text>
  
  <!-- Input Signal Visualization -->
  <rect x="200" y="500" width="150" height="80" rx="3" ry="3" fill="white" stroke="#ff5a4c" stroke-width="2" stroke-dasharray="5,3" />
  <rect x="450" y="500" width="150" height="80" rx="3" ry="3" fill="white" stroke="#4a8fe5" stroke-width="2" stroke-dasharray="5,3" />
  <text x="400" y="530" font-family="Arial" font-size="16" fill="#333" font-weight="bold">. . .</text>
  
  <!-- Input Signal Waves -->
  <path d="M 200 540 Q 210 520 220 540 Q 230 560 240 540 Q 250 520 260 540 Q 270 560 280 540 Q 290 520 300 540 Q 310 560 320 540 Q 330 520 340 540 Q 350 560 350 540" stroke="#2eea71" stroke-width="2.5" fill="none" />
  <path d="M 200 550 Q 215 530 230 550 Q 245 570 260 550 Q 275 530 290 550 Q 305 570 320 550 Q 335 530 350 550" stroke="#34b8ff" stroke-width="2.5" fill="none" />
  <path d="M 200 555 Q 220 535 240 555 Q 260 575 280 555 Q 300 535 320 555 Q 340 575 350 555" stroke="#ff5a4c" stroke-width="2.5" fill="none" />
  
  <path d="M 450 540 Q 460 520 470 540 Q 480 560 490 540 Q 500 520 510 540 Q 520 560 530 540 Q 540 520 550 540 Q 560 560 570 540 Q 580 520 600 540" stroke="#2eea71" stroke-width="2.5" fill="none" />
  <path d="M 450 550 Q 465 530 480 550 Q 495 570 510 550 Q 525 530 540 550 Q 555 570 570 550 Q 585 530 600 550" stroke="#b969f6" stroke-width="2.5" fill="none" />
  <path d="M 450 555 Q 470 535 490 555 Q 510 575 530 555 Q 550 535 570 555 Q 590 575 600 555" stroke="#ffe40f" stroke-width="2.5" fill="none" />
  
  <!-- Connections -->
  <!-- From Input to Conv Block 3 -->
  <line x1="230" y1="500" x2="245" y2="470" stroke="#e74c3c" stroke-width="1.5" stroke-dasharray="5,3" />
  <line x1="270" y1="500" x2="270" y2="470" stroke="#e74c3c" stroke-width="1.5" stroke-dasharray="5,3" />
  <line x1="320" y1="500" x2="295" y2="470" stroke="#e74c3c" stroke-width="1.5" stroke-dasharray="5,3" />
  
  <line x1="480" y1="500" x2="510" y2="470" stroke="#2c3e50" stroke-width="1.5" stroke-dasharray="5,3" />
  <line x1="520" y1="500" x2="535" y2="470" stroke="#2c3e50" stroke-width="1.5" stroke-dasharray="5,3" />
  <line x1="570" y1="500" x2="560" y2="470" stroke="#2c3e50" stroke-width="1.5" stroke-dasharray="5,3" />
  
  <!-- From Conv Block 3 to Conv Block 2 -->
  <line x1="245" y1="435" x2="245" y2="395" stroke="#2c3e50" stroke-width="1" />
  <line x1="270" y1="435" x2="265" y2="395" stroke="#2c3e50" stroke-width="1" />
  <line x1="295" y1="435" x2="335" y2="395" stroke="#e74c3c" stroke-width="1" />
  
  <line x1="510" y1="435" x2="555" y2="395" stroke="#2c3e50" stroke-width="1" />
  <line x1="535" y1="435" x2="535" y2="395" stroke="#2c3e50" stroke-width="1" />
  <line x1="560" y1="435" x2="535" y2="395" stroke="#2c3e50" stroke-width="1" />
  
  <!-- From Conv Block 2 to Conv Block 1 -->
  <line x1="245" y1="365" x2="245" y2="325" stroke="#2c3e50" stroke-width="1" />
  <line x1="265" y1="365" x2="265" y2="325" stroke="#2c3e50" stroke-width="1" />
  <line x1="335" y1="365" x2="335" y2="325" stroke="#2c3e50" stroke-width="1" />
  <line x1="355" y1="365" x2="355" y2="325" stroke="#2c3e50" stroke-width="1" />
  <line x1="535" y1="365" x2="535" y2="325" stroke="#2c3e50" stroke-width="1" />
  <line x1="555" y1="365" x2="555" y2="325" stroke="#2c3e50" stroke-width="1" />
  
  <!-- From Conv Block 1 to FC Layer -->
  <line x1="230" y1="290" x2="235" y2="260" stroke="#2c3e50" stroke-width="1.5" stroke-dasharray="3,2" />
  <line x1="335" y1="290" x2="275" y2="260" stroke="#e74c3c" stroke-width="1.5" stroke-dasharray="3,2" />
  <line x1="555" y1="290" x2="565" y2="260" stroke="#2c3e50" stroke-width="1.5" stroke-dasharray="3,2" />
  
  <!-- From FC Layer to Transformer Layer -->
  <line x1="235" y1="220" x2="235" y2="190" stroke="#2c3e50" stroke-width="1.5" />
  <line x1="275" y1="220" x2="315" y2="190" stroke="#e74c3c" stroke-width="1.5" />
  <line x1="565" y1="220" x2="565" y2="190" stroke="#2c3e50" stroke-width="1.5" />
  
  <!-- From Transformer Layer to Output Layer -->
  <line x1="235" y1="150" x2="235" y2="120" stroke="#2c3e50" stroke-width="1.5" />
  <line x1="275" y1="150" x2="275" y2="120" stroke="#2c3e50" stroke-width="1.5" />
  <line x1="315" y1="150" x2="315" y2="120" stroke="#2c3e50" stroke-width="1.5" />
  <line x1="565" y1="150" x2="565" y2="120" stroke="#2c3e50" stroke-width="1.5" />
  
  <!-- Legend -->
  <text x="400" y="600" font-family="Arial" font-size="18" font-weight="bold" text-anchor="middle" fill="#333">颜色图例</text>
  <circle cx="270" y="620" r="10" fill="url(#orangeGradient)" stroke="#2c3e50" stroke-width="1" />
  <text x="290" y="625" font-family="Arial" font-size="14" fill="#333">类型 A</text>
  <circle cx="350" y="620" r="10" fill="url(#redGradient)" stroke="#2c3e50" stroke-width="1" />
  <text x="370" y="625" font-family="Arial" font-size="14" fill="#333">类型 B</text>
  <circle cx="430" y="620" r="10" fill="url(#yellowGradient)" stroke="#2c3e50" stroke-width="1" />
  <text x="450" y="625" font-family="Arial" font-size="14" fill="#333">类型 C</text>
  <circle cx="510" y="620" r="10" fill="url(#purpleGradient)" stroke="#2c3e50" stroke-width="1" />
  <text x="530" y="625" font-family="Arial" font-size="14" fill="#333">Transformer</text>
</svg>